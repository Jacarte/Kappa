
\msection{Comparing CROW, MEWE, and WASM-MUTATE}

In this section, we compare CROW, MEWE, and WASM-MUTATE, highlighting their key differences. 
These distinctions are summarized in \autoref{comp:table:tools}. 
The table is organized into columns that represent attributes of each tool: the tool's name, input format, core diversification strategy, number of variants generated within an hour, targeted sections of the \Wasm binary for diversification, strength of the generated variants, and the security applications of these variants. 
Each row in the table corresponds to a specific tool. 
The \emph{Variant strength} accounts for the capability of each tool on generating variants that are preserved after the JIT compilation of V8 and wasmtime in average.
For example, a higher value of the \emph{Variant strength} indicates that the generated variants are not reversed by JIT compilers, ensuring that the diversification is preserved in an end-to-end scenario of a \Wasm program, i.e. from the source code to its final execution.
Notice that, the data and insights presented in the table are sourced from the respective papers of each tool and, from the previous discussion in this chapter.



%% 
\definecolor{Gray}{gray}{0.95}
\newcolumntype{a}{>{\columncolor{Gray}}p{0.13\linewidth}}
\newcolumntype{b}{>{\columncolor{Gray}}p{0.22\linewidth}}
\begin{landscape}
    


    \begin{table}
        \begin{tabular}{ p{0.1\linewidth} | a | a | p{0.08\linewidth} | p{0.1\linewidth} | p{0.08\linewidth} | b} 
            \hline
            \textbf{Tool} & \textbf{Input} & \textbf{Core} & \textbf{Variants in 1h} & \textbf{Target}  & \textbf{Variants Strength} & \textbf{Security applications} \\
            \hline \hline
            CROW & Source code or LLVM Ir & Enumerative synthesis with functional equivalence proved through SMT solvers & > 1k & Code section  & \textbf{96\%} & Hinders static analysis reverse engineering.  \\
            \hline
            MEWE & Source code or LL
            VM Ir & Multivariant execution  & > 1k & Code and Function sections  & \textbf{96\%} & Hinders static and dynamic analysis reverse engineering, web timing-based attacks.  \\
            \hline
            WASM-MUTATE &  \textbf{Wasm binary} & hand-made rewriting rules, e-graph random traversals & \textbf{> 10k}  & \textbf{Any Wasm section}  & 76\% & Hinders signature-based identification, and timing side-channel attacks. \\
            
        \end{tabular}
        \caption{Comparing CROW, MEWE and WASM-MUTATE. The table columns are: the tool's name, input format, core diversification strategy, number of variants generated within an hour, targeted sections of the \Wasm binary, strength of the generated variants, and the security applications of these variants. 
        The \emph{Variant strength} accounts for the capability of each tool on generating variants that are preserved after the JIT compilation of V8 and wasmtime in average.
        Our three technical contributions are complementary tools that can be combined.
        \label{comp:table:tools}}
    \end{table}
\end{landscape}


\begin{tcolorbox}[title=Takeaway,boxrule=1pt,arc=.2em,boxsep=1.0mm]
    
    Our three technical contributions serve as complementary tools that can be combined.
    For instance, when the source code for a \Wasm binary is either non-existent or inaccessible, WASM-MUTATE offers a viable solution for generating code variants. 
    On the other hand, CROW and MEWE excel in scenarios where high preservation is crucial. 
\end{tcolorbox}


\msubsection{Security applications}


The last column of \autoref{comp:table:tools} highlights the security applications of the variants generated by our three technical contributions.
The first direct consequence of changing the structure of \wasm binaries from variant to variant is that signature-based identification is mitigated, i.e. static analysis is hardened.
Moreover, our tools generate many different and highly preserved code variants. 
This means that these variants, each with unique \Wasm codes, maintain their distinctiveness even after JIT compilers translate them into machine codes (see \autoref{background:wasm:ecosystems}). 
The preservation feature significantly reduces the impact of side-channel attacks that exploit specific machine code instructions, e.g., port contention \cite{10.1145/3488932.3517411}.


Altering the layout of a \Wasm program inherently influences its managed memory during runtime (see \autoref{managed_unmanaged}).
This phenomenon is especially important for CROW and MEWE, given that they do not directly address the \Wasm memory model.
Significantly, CROW and MEWE considerably alter the managed memory by modifying the layout of the \Wasm program.
For example, the \emph{constant inferring} transformations significantly alter the layout of program variants, affecting unmanaged memory elements such as the returning address of a function.
Furthermore, WASM-MUTATE not only affects managed memory through changes in the \Wasm program layout.
It also adds rewriting rules to transform unmanaged memory instructions.
Memory alterations, either to the unmanaged or managed memories, have substantial security implications, by eliminating potential jump points that facilitate malicious activities within the binary \cite{Swivel}.


Besides, our technical contributions enhance security against timing-based attacks by creating variants that exhibit a wide range of execution times, including faster variants compared to the original program. 
This strategy is especially prominent in MEWEâ€™s approach, which develops multivariants functioning on randomizing execution paths, thereby thwarting attempts at timing-based inference attacks \cite{DBLP:conf/ndss/SchnitzlerKBP23}. 
Adding another layer benefit, the integration of diverse variants into multivariants can potentially disrupt dynamic analysis tools such as symbolic executors \cite{wasmixer}. 
Concretely, different control flows through a random discriminator, exponentially increase the number of possible execution paths, making multivariant binaries virtually unexplorable.


\begin{tcolorbox}[title=Takeaway,boxrule=1pt,arc=.2em,boxsep=1.0mm]
    CROW, MEWE and WASM-MUTATE generate \Wasm variants that can be used to enhance security. 
    Overall, they generate variants that are suitable for hindering static and dynamic reverse engineering, side-channel attacks, and to thwart signature-based identification. 
\end{tcolorbox}


\msection{Conclusions}

In this chapter, we discuss the technical specifics underlying our primary technical contributions.
We elucidate the mechanisms through which CROW generates program variants.
Subsequently, we discuss MEWE, offering a detailed examination of its role in forging MVE for \Wasm. 
We also explore the details of WASM-MUTATE, proposing a novel e-graph traversal algorithm to fast spawn \wasm program variants. 
Remarkably, we undertake a comparative analysis of the three tools, highlighting their respective benefits and limitations, alongside the potential security applications of the generated \wasm variants. 

In \autoref{exploit}, we present two use cases that support the exploitation of these tools.
\autoref{exploit} serves to bridge theory with practice, showcasing the tangible impacts and benefits realized through the deployment of CROW, MEWE, and WASM-MUTATE.
