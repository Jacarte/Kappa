\msection{Preservation of \Wasm's diversification}
\label{exploit:discussion_bad}

In \autoref{exploit:defensive}, we have noted an increasing trend of exfiltration bandwidth in certain variants. 
\autoref{offensive_app} presents a similar case, indicating that without a clear objective in the diversification process, stochastic diversification can be counterproductive. 
We observed that the preservation of variants is the primary cause of such phenomena. 

Preservation refers to the ability of a transformation at the \Wasm level to maintain the machine code of the original \Wasm program.
In concrete, some transformations result in distinct \Wasm binaries, yet identical machine code is produced upon their JIT compilation.
Transformations that are not preserved can compromise the effectiveness of diversification.
For instance, the inclusion of random \texttt{nop} operations directly into \Wasm. 
Our experiments show that this specific transformation does not change the final machine code because JIT compilers typically eliminate \texttt{nop} operations.
This phenomenon is similarly noticed with transformations to the custom sections of \Wasm binaries.

In the context of \Wasm malware detection, this means that identical machine code, even when their \Wasm variants are different, can be detected by malware detectors.
For practitioners, malware detection tools can be enhanced by incorporating a pre-compilation step to normalize \Wasm binaries.
To the best of our knowledge, the current antivirus do not do this process.
Besides, developers could focus on transformations that preserve the machine code, as they are more likely to contribute to the diversification objectives, e.g., evasion.

On the other hand, side-channel attacks occur at the machine code level. 
Preserving \Wasm variants is thus essential for successful defensive diversification. 
If the machine code for the generated variants is preserved, the original \Wasm program's side-channel attack is not effective against the variant.

%\msection{Intrinsic benefits of diversification for \Wasm}
%\label{exploit:discussion_good}

%In the following, we elaborate on two concrete security benefits that our contributions provide to \Wasm variants through diversification.
 


